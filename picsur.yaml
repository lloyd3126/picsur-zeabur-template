apiVersion: zeabur.com/v1
kind: Template
metadata:
  name: Picsur
spec:
  description: An easy to use, selfhostable image sharing service like Imgur with built in converting
  icon: https://raw.githubusercontent.com/CaramelFur/Picsur/bdb4a5a8ad28539edb98e586727ea26ddf15f078/branding/logo/picsur.svg
  coverImage: https://raw.githubusercontent.com/CaramelFur/Picsur/bdb4a5a8ad28539edb98e586727ea26ddf15f078/branding/logo/picsur.svg
  tags:
    - Tool
    - Image
    - Storage
  variables:
    - key: PICSUR_DOMAIN
      type: DOMAIN
      name: Domain
      description: What is the domain you want for your Picsur instance?
    - key: ADMIN_PASSWORD
      type: STRING
      name: Admin Password
      description: The password for the admin account (default username is 'admin')
  readme: |-
    # Picsur

    An easy to use, selfhostable image sharing service like Imgur with built in converting.

    ## Features

    - ğŸ–¼ï¸ Upload and view images
    - ğŸ‘¤ User accounts with roles and permissions
    - ğŸ”„ Convert images between formats (QOI, JPG, PNG, WEBP, TIFF, HEIF, BMP, GIF, JPG-XL, JPG-2000)
    - âœ‚ï¸ Edit images (Resize, Rotate, Flip, Strip transparency, Negative, Greyscale)
    - ğŸ—‘ï¸ Deletable and expiring images
    - ğŸ“¤ ShareX endpoint support
    - ğŸ”’ Proper CORS restrictions and Exif stripping

    ## Default Admin Login

    - **Username**: `admin`
    - **Password**: The password you set during deployment

    ## After Deployment

    1. Visit your domain to access Picsur
    2. Login with username `admin` and your password
    3. Go to Settings to configure:
       - User registration permissions
       - Keep original image files option
       - Maximum file size
       - Other preferences

    ## Documentation

    For more information, visit the [official Picsur documentation](https://github.com/CaramelFur/Picsur).

  services:
    - name: postgres
      icon: https://raw.githubusercontent.com/zeabur/service-icons/main/marketplace/postgresql.svg
      template: PREBUILT
      spec:
        source:
          image: postgres:17-alpine
        ports:
          - id: database
            port: 5432
            type: TCP
        volumes:
          - id: data
            dir: /var/lib/postgresql/data
        env:
          POSTGRES_CONNECTION_STRING:
            default: postgresql://${POSTGRES_USERNAME}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DATABASE}
            expose: true
          POSTGRES_DATABASE:
            default: ${POSTGRES_DB}
            expose: true
          POSTGRES_DB:
            default: picsur
          POSTGRES_HOST:
            default: ${CONTAINER_HOSTNAME}
            expose: true
          POSTGRES_PASSWORD:
            default: ${PASSWORD}
            expose: true
          POSTGRES_PORT:
            default: ${DATABASE_PORT}
            expose: true
          POSTGRES_USER:
            default: picsur
          POSTGRES_USERNAME:
            default: ${POSTGRES_USER}
            expose: true
        instructions:
          - type: TEXT
            title: Database Connection String
            content: postgresql://${POSTGRES_USERNAME}:${POSTGRES_PASSWORD}@${PORT_FORWARDED_HOSTNAME}:${DATABASE_PORT_FORWARDED_PORT}/${POSTGRES_DATABASE}
            category: Connection Info
          - type: TEXT
            title: Database Host
            content: ${PORT_FORWARDED_HOSTNAME}
            category: Connection Info
          - type: TEXT
            title: Database Port
            content: ${DATABASE_PORT_FORWARDED_PORT}
            category: Connection Info
          - type: PASSWORD
            title: Database Password
            content: ${POSTGRES_PASSWORD}
            category: Credentials

    - name: picsur
      icon: https://raw.githubusercontent.com/CaramelFur/Picsur/bdb4a5a8ad28539edb98e586727ea26ddf15f078/branding/logo/picsur.svg
      template: PREBUILT
      domainKey: PICSUR_DOMAIN
      dependencies:
        - postgres
      spec:
        source:
          image: ghcr.io/caramelfur/picsur:latest
        ports:
          - id: web
            port: 8080
            type: HTTP
        env:
          PICSUR_HOST:
            default: "0.0.0.0"
          PICSUR_PORT:
            default: "8080"
          PICSUR_DB_HOST:
            default: ${POSTGRES_HOST}
          PICSUR_DB_PORT:
            default: ${POSTGRES_PORT}
          PICSUR_DB_USERNAME:
            default: ${POSTGRES_USERNAME}
          PICSUR_DB_PASSWORD:
            default: ${POSTGRES_PASSWORD}
          PICSUR_DB_DATABASE:
            default: ${POSTGRES_DATABASE}
          PICSUR_ADMIN_PASSWORD:
            default: ${ADMIN_PASSWORD}
          PICSUR_MAX_FILE_SIZE:
            default: "128000000"
        instructions:
          - type: DOMAIN
            title: Picsur URL
            content: https://${PICSUR_DOMAIN}
            category: Access
          - type: TEXT
            title: Admin Username
            content: admin
            category: Credentials
          - type: PASSWORD
            title: Admin Password
            content: ${ADMIN_PASSWORD}
            category: Credentials

localization:
  zh-TW:
    description: ä¸€å€‹æ˜“æ–¼ä½¿ç”¨ã€å¯è‡ªæ¶çš„åœ–ç‰‡åˆ†äº«æœå‹™ï¼Œé¡ä¼¼ Imgurï¼Œå…§å»ºæ ¼å¼è½‰æ›åŠŸèƒ½
    variables:
      - key: PICSUR_DOMAIN
        type: DOMAIN
        name: åŸŸå
        description: ä½ æƒ³ç‚º Picsur å¯¦ä¾‹ä½¿ç”¨ä»€éº¼åŸŸåï¼Ÿ
      - key: ADMIN_PASSWORD
        type: STRING
        name: ç®¡ç†å“¡å¯†ç¢¼
        description: ç®¡ç†å“¡å¸³è™Ÿçš„å¯†ç¢¼ï¼ˆé è¨­ä½¿ç”¨è€…åç¨±ç‚º 'admin'ï¼‰
    readme: |-
      # Picsur

      ä¸€å€‹æ˜“æ–¼ä½¿ç”¨ã€å¯è‡ªæ¶çš„åœ–ç‰‡åˆ†äº«æœå‹™ï¼Œé¡ä¼¼ Imgurï¼Œå…§å»ºæ ¼å¼è½‰æ›åŠŸèƒ½ã€‚

      ## åŠŸèƒ½ç‰¹è‰²

      - ğŸ–¼ï¸ ä¸Šå‚³å’ŒæŸ¥çœ‹åœ–ç‰‡
      - ğŸ‘¤ å…·æœ‰è§’è‰²å’Œæ¬Šé™çš„ä½¿ç”¨è€…å¸³è™Ÿç³»çµ±
      - ğŸ”„ åœ¨å¤šç¨®æ ¼å¼é–“è½‰æ›åœ–ç‰‡ï¼ˆQOIã€JPGã€PNGã€WEBPã€TIFFã€HEIFã€BMPã€GIFã€JPG-XLã€JPG-2000ï¼‰
      - âœ‚ï¸ ç·¨è¼¯åœ–ç‰‡ï¼ˆèª¿æ•´å¤§å°ã€æ—‹è½‰ã€ç¿»è½‰ã€ç§»é™¤é€æ˜åº¦ã€è² ç‰‡ã€ç°éšï¼‰
      - ğŸ—‘ï¸ å¯åˆªé™¤å’Œè¨­å®šéæœŸçš„åœ–ç‰‡
      - ğŸ“¤ æ”¯æ´ ShareX ç«¯é»
      - ğŸ”’ é©ç•¶çš„ CORS é™åˆ¶å’Œ Exif è³‡æ–™æ¸…é™¤

      ## é è¨­ç®¡ç†å“¡ç™»å…¥è³‡è¨Š

      - **ä½¿ç”¨è€…åç¨±**ï¼š`admin`
      - **å¯†ç¢¼**ï¼šä½ åœ¨éƒ¨ç½²æ™‚è¨­å®šçš„å¯†ç¢¼

      ## éƒ¨ç½²å¾Œæ­¥é©Ÿ

      1. è¨ªå•ä½ çš„åŸŸåä»¥å­˜å– Picsur
      2. ä½¿ç”¨ä½¿ç”¨è€…åç¨± `admin` å’Œä½ çš„å¯†ç¢¼ç™»å…¥
      3. å‰å¾€è¨­å®šé é¢é€²è¡Œé…ç½®ï¼š
         - ä½¿ç”¨è€…è¨»å†Šæ¬Šé™
         - ä¿ç•™åŸå§‹åœ–ç‰‡æª”æ¡ˆé¸é …
         - æœ€å¤§æª”æ¡ˆå¤§å°
         - å…¶ä»–åå¥½è¨­å®š

      ## æ–‡ä»¶

      æ›´å¤šè³‡è¨Šè«‹è¨ªå• [Picsur å®˜æ–¹æ–‡ä»¶](https://github.com/CaramelFur/Picsur)ã€‚
